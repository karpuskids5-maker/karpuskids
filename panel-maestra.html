<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Panel de Maestra - Karpus Kids</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="js/auth.js?v=1"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            karpus: {
              orange: '#FF8A00', 
              pink: '#FF4081', 
              blue: '#2196F3', 
              green: '#4CAF50',
              purple: '#9C27B0',
              teal: '#009688',
              yellow: '#FFC107'
            }
          },
          fontFamily: {
            nunito: ['Nunito', 'sans-serif'],
            poppins: ['Poppins', 'sans-serif'],
          },
          borderRadius: { '3xl': '1.5rem' }
        }
      }
    };
  </script>
  
  <style>
    /* Sidebar styles (unificado) */
    aside#sidebar { width: 280px; transition: width .25s ease, transform .25s ease; }
    aside#sidebar.collapsed { width: 72px; }
    aside#sidebar .label { transition: opacity .2s ease; }
    aside#sidebar.collapsed .label { opacity: 0; }
    
    /* Hover expand logic */
    aside#sidebar.collapsed:hover { width: 280px; }
    aside#sidebar.collapsed:hover .label { opacity: 1; }
    aside#sidebar.collapsed:hover .badge { opacity: 1; }
    aside#sidebar.collapsed .badge { opacity: 0; transition: opacity .2s; }

    /* mobile helper */
    .hidden-mobile { display: none !important; }
    /* color variants */
    .sidebar-rose { background: linear-gradient(135deg, #ec4899, #be185d); } /* Pink-500 to Pink-700 */
    .sidebar-blue { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
    
    /* soft shadow used in many places - prefer Tailwind utilities (shadow-lg) */
    /* Karpus colored letters small */
    .karpus-kids-inline { font-weight: 700; }
    .karpus-kids-inline .k-1 { color: #FF9800; }
    .karpus-kids-inline .k-2 { color: #2196F3; }
    .karpus-kids-inline .k-3 { color: #E91E63; }
    .karpus-kids-inline .k-4 { color: #4CAF50; }
    .karpus-kids-inline .k-5 { color: #FF9800; }
    .karpus-kids-inline .k-6 { color: #2196F3; }
    .karpus-kids-inline .k-7 { color: #4CAF50; }
    .karpus-kids-inline .k-8 { color: #E91E63; }
    .karpus-kids-inline .k-9 { color: #2196F3; }
    .karpus-kids-inline .k-10 { color: #FF9800; }
    
    /* Estilos para modales más grandes y profesionales */
    .modal-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .modal-container.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-content {
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }
    
    .modal-container.active .modal-content {
      transform: scale(1);
    }
    
    .modal-header {
      padding: 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .modal-body {
      padding: 1.5rem;
    }
    
    .modal-footer {
      padding: 1.5rem;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
    }

    /* Layout adjustments */
    #layoutShell { transition: margin-left .25s ease; }
    #layoutShell.sidebar-collapsed { margin-left: 72px !important; }
    
    @media (max-width: 768px) {
      #layoutShell { margin-left: 0 !important; }
    }
    
    /* Modern card fixes: ensure responsive wrapping, consistent sizing and no overflow */
    .modern-card { box-sizing: border-box; padding: 1rem; border-radius: 1rem; overflow: hidden; }
    .modern-card .flex { flex-wrap: wrap; gap: 0.75rem; }
    .modern-card h2, .modern-card h3, .modern-card p { word-break: break-word; white-space: normal; }
    .modern-card img, .modern-card canvas, .modern-card video { max-width: 100%; height: auto; display: block; }

    /* Prevent jumpy header when sidebar toggles */
    
    /* Estilos para formularios en modales */
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: #374151;
    }
    
    .form-input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      background-color: #f9fafb;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .form-select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      background-color: #f9fafb;
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.75rem center;
      background-repeat: no-repeat;
      background-size: 1.25rem;
    }
    /* Helper classes used by JS */
    .no-scroll { overflow: hidden; }
    #sidebarOverlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.32); z-index: 60; }
    #sidebarOverlay.active { display: block; }

    /* Section transitions: JS will toggle .section-visible and .hidden */
    main section[id^="t-"] { opacity: 0; transform: translateY(6px); transition: opacity .18s ease, transform .18s ease; }
    main section[id^="t-"].section-visible { opacity: 1; transform: none; }

    /* Mobile sidebar helper */
    aside#sidebar.mobile-visible { transform: translateX(0); }
    aside#sidebar.mobile-hidden { transform: translateX(-100%); }
    
    .nav-btn { width: 100%; text-align: left; padding: 0.75rem 1rem; border-radius: 0.5rem; display: flex; align-items: center; gap: 0.75rem; transition: all 0.2s ease; position: relative; }
    .nav-btn:hover { background-color: rgba(255,255,255,0.2); }
    .nav-btn.active { background-color: rgba(255,255,255,0.2); }
    .nav-btn .badge { position: absolute; top: 0.5rem; right: 0.5rem; background: #f43f5e; color: white; border-radius: 9999px; font-size: 0.75rem; padding: 0.125rem 0.375rem; min-width: 1.5rem; text-align: center; }
  </style>
</head>
<body class="bg-gradient-to-b from-white to-slate-50 text-slate-900 min-h-screen">
  <div class="min-h-screen flex font-nunito">
    <!-- Sidebar -->
    <aside id="sidebar" class="hidden md:block sidebar-rose p-4 rounded-r-3xl shadow-lg fixed inset-y-0 left-0 z-10">
      <button id="toggleSidebar" class="absolute -right-4 top-6 bg-white rounded-full w-11 h-11 flex items-center justify-center shadow-lg border border-white/60 text-slate-600 hover:bg-white hover:scale-105 transition-all hidden md:flex"><span class="sr-only">Colapsar sidebar</span><i id="toggleSidebarIcon" data-lucide="chevrons-left" class="w-6 h-6"></i></button>
      <div class="flex items-center gap-3 mb-6">
        <div class="h-12 w-12 rounded-2xl bg-white/20 flex items-center justify-center shadow-lg">
          <img src="img/mundo.jpg" alt="logo" class="h-10 w-10 rounded-lg object-cover" />
        </div>
        <div class="label">
          <h3 class="font-semibold text-white"><span class="karpus-kids-inline"><span class="k-1">K</span><span class="k-2">a</span><span class="k-3">r</span><span class="k-4">p</span><span class="k-5">u</span><span class="k-6">s</span> <span class="k-7">K</span><span class="k-8">i</span><span class="k-9">d</span><span class="k-10">s</span></span></h3>
          <p class="text-xs text-white text-opacity-80">Panel - Maestra</p>
        </div>
      </div>

  <div id="modalEditTask" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Editar tarea</h3>
      <input id="editTaskTitle" class="w-full border rounded-xl p-2 text-sm" placeholder="Título" />
      <textarea id="editTaskDesc" class="w-full border rounded-xl p-2 text-sm mt-2" rows="3" placeholder="Descripción"></textarea>
      <label class="block text-xs text-slate-600 mt-2">Fecha de publicación</label>
      <input id="editTaskPublish" type="date" class="w-full border rounded-xl p-2 text-sm" />
      <label class="block text-xs text-slate-600 mt-2">Fecha de entrega</label>
      <input id="editTaskDue" type="date" class="w-full border rounded-xl p-2 text-sm" />
      <label class="block text-xs text-slate-600 mt-2">Adjuntar archivos adicionales</label>
      <input id="editTaskFiles" type="file" multiple accept="image/*,video/*,.pdf,.doc,.docx,.xls,.xlsx" class="w-full border rounded-xl p-2 text-sm" />
      <div class="flex justify-end gap-2 mt-3">
        <button id="closeEditTask" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cancelar</button>
        <button id="submitEditTask" class="text-sm px-3 py-2 rounded-xl bg-karpus-blue text-white">Guardar</button>
      </div>
    </div>
  </div>

  <div id="modalAttendanceDetails" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-96">
      <h3 class="text-sm font-semibold mb-2">Detalles de Asistencia</h3>
      <div id="attendanceDetailsContent" class="space-y-2 max-h-80 overflow-auto">
        <!-- Contenido dinámico de asistencia -->
      </div>
      <div class="flex justify-end mt-3">
        <button id="closeAttendanceDetails" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button>
      </div>
    </div>
  </div>

      <nav class="space-y-2 teams-nav bg-white/10 p-2 rounded-xl mb-4" aria-label="Navegación de la maestra">
        <button data-section="t-home" class="nav-btn text-white" title="Inicio">
          <i data-lucide="layout-grid" class="text-white"></i>
          <span class="label text-white">Mis Clases</span>
        </button>
        <button data-section="t-calendar" class="nav-btn text-white">
          <i data-lucide="calendar" class="text-white"></i>
          <span class="label text-white">Calendario</span>
        </button>
        <button data-section="t-profile" class="nav-btn text-white">
          <i data-lucide="user" class="text-white"></i>
          <span class="label text-white">Perfil</span>
        </button>
        <!-- bottom fixed items are placed separately to remain at the bottom -->
      </nav>

      <div class="sidebar-bottom mt-auto pt-4 space-y-2">
        <a href="index.html" class="nav-btn text-white" title="Cerrar sesión">
          <i data-lucide="log-out" class="text-white"></i>
          <span class="label text-white">Cerrar sesión</span>
        </a>
        <div class="mt-3 text-xs text-white text-opacity-80 px-2">Maestra: Ana</div>
      </div>
      
        <!-- Selector de color eliminado: estilo único de sidebar -->
    </aside>

    <main class="flex-1 p-6 ml-[280px]" id="layoutShell">
      <!-- Header Mobile / Topbar -->
      <div class="mb-6 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button id="menuBtn" class="md:hidden p-2 rounded bg-white shadow"><i data-lucide="menu" class="w-5 h-5"></i></button>
          <h1 class="text-2xl font-bold text-slate-800">Panel de Maestra</h1>
        </div>
        <div class="text-sm text-slate-500">Bienvenida, Ana</div>
      </div>

    <!-- Dashboard -->
    <section id="t-home" class="section space-y-4">
      <h2 class="text-xl font-semibold flex items-center gap-2">
        <i data-lucide="layout-grid" class="w-5 h-5 text-karpus-blue"></i><span>Mis Clases Asignadas</span>
      </h2>
      <p class="text-sm text-slate-500">Selecciona un aula para gestionar publicaciones, tareas y calificaciones.</p>
      
      <!-- Grid de Clases -->
      <div id="classesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
        <!-- Se llena dinámicamente con JS -->
      </div>
    </section>

    <!-- Class Detail View (Hidden by default) -->
    <section id="t-class-detail" class="section space-y-4 hidden">
      <!-- Class Header -->
      <div class="flex items-center justify-between bg-white p-4 rounded-3xl border shadow-sm">
        <div class="flex items-center gap-4">
          <button id="backToClasses" class="p-2 rounded-full hover:bg-slate-100 transition-colors">
            <i data-lucide="arrow-left" class="w-5 h-5 text-slate-600"></i>
          </button>
          <div>
            <h2 id="currentClassName" class="text-2xl font-bold text-slate-800">1° A</h2>
            <p class="text-xs text-slate-500">Gestión de Aula</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button class="p-2 rounded-full bg-slate-50 text-slate-600 hover:bg-slate-100" title="Configuración de aula"><i data-lucide="settings" class="w-4 h-4"></i></button>
        </div>
      </div>

      <!-- Class Tabs -->
      <div class="flex gap-2 overflow-x-auto pb-2 border-b">
        <button class="class-tab-btn active px-4 py-2 rounded-xl text-sm font-semibold bg-karpus-blue text-white transition-all" data-tab="feed">
          Publicaciones
        </button>
        <button class="class-tab-btn px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-all" data-tab="tasks">
          Tareas
        </button>
        <button class="class-tab-btn px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-all" data-tab="grades">
          Calificaciones
        </button>
        <button class="class-tab-btn px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-all" data-tab="private-chat">
          Mensajes Privados
        </button>
        <button class="class-tab-btn px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-all" data-tab="attendance">
          Asistencia
        </button>
      </div>

      <!-- Tab Contents -->
      
      <!-- TAB: FEED -->
      <div id="tab-feed" class="class-tab-content space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold">Muro del Aula</h3>
          <button id="openAddPost" class="text-sm px-4 py-2 rounded-xl bg-karpus-orange text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2">
            <i data-lucide="plus" class="w-4 h-4"></i> Nueva Publicación
          </button>
        </div>
        <!-- Feed Container reused -->
        <div id="classroomFeed" class="space-y-4"></div>
      </div>

      <!-- TAB: TASKS -->
      <div id="tab-tasks" class="class-tab-content space-y-4 hidden">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold">Tareas Asignadas</h3>
          <button id="openCreateTask" class="text-sm px-4 py-2 rounded-xl bg-karpus-blue text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2">
            <i data-lucide="plus" class="w-4 h-4"></i> Crear Tarea
          </button>
        </div>
        <div class="flex gap-2 overflow-x-auto pb-1">
          <button class="task-filter-btn active px-3 py-1 rounded-full text-xs font-medium bg-slate-800 text-white" data-filter="all">Todas</button>
          <button class="task-filter-btn px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600" data-filter="pending">Pendientes</button>
          <button class="task-filter-btn px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600" data-filter="submitted">Entregadas</button>
          <button class="task-filter-btn px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600" data-filter="overdue">Vencidas</button>
        </div>
        <div id="taskList" class="grid gap-3"></div>
      </div>

      <!-- TAB: GRADES -->
      <div id="tab-grades" class="class-tab-content space-y-4 hidden">
        <div class="bg-white rounded-3xl border shadow-sm overflow-hidden">
           <div class="overflow-x-auto">
             <table class="w-full text-left border-collapse">
               <thead>
                 <tr class="bg-slate-50 border-b">
                   <th class="p-4 font-semibold text-slate-600 w-1/3">Estudiante</th>
                   <th class="p-4 font-semibold text-slate-600 text-center">Entregas</th>
                   <th class="p-4 font-semibold text-slate-600 text-center">Promedio</th>
                   <th class="p-4 font-semibold text-slate-600">Observación</th>
                   <th class="p-4 font-semibold text-slate-600 text-right">Acciones</th>
                 </tr>
               </thead>
               <tbody id="gradesTableBody">
                 <!-- Grades loaded via JS -->
               </tbody>
             </table>
           </div>
        </div>
      </div>

      <!-- TAB: PRIVATE CHAT -->
      <div id="tab-private-chat" class="class-tab-content hidden">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 h-[600px]">
          <!-- Students List -->
          <div class="bg-white rounded-3xl border shadow-sm flex flex-col overflow-hidden">
             <div class="p-4 border-b bg-slate-50">
               <h4 class="font-bold text-slate-700">Contactos del aula</h4>
             </div>
             <div class="flex-1 overflow-y-auto p-2 space-y-1" id="privateChatList">
               <!-- Mock Student List -->
               <div class="p-3 rounded-xl hover:bg-slate-50 cursor-pointer flex items-center gap-3">
                 <div class="relative">
                   <div class="h-10 w-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold">A</div>
                   <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full"></span>
                 </div>
                 <div>
                   <div class="font-bold text-slate-800 text-sm">Andrea Flores</div>
                   <div class="text-xs text-slate-500 truncate w-32">Madre: Hola maestra...</div>
                 </div>
               </div>
               <div class="p-3 rounded-xl hover:bg-slate-50 cursor-pointer flex items-center gap-3 bg-blue-50">
                 <div class="relative">
                   <div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold">J</div>
                 </div>
                 <div>
                   <div class="font-bold text-slate-800 text-sm">Juan Pérez</div>
                   <div class="text-xs text-slate-500 truncate w-32">Padre: Gracias...</div>
                 </div>
               </div>
             </div>
          </div>
          
          <!-- Chat Window -->
          <div class="md:col-span-2 bg-white rounded-3xl border shadow-sm flex flex-col overflow-hidden">
             <div class="p-4 border-b flex items-center justify-between bg-slate-50">
               <div class="flex items-center gap-3">
                 <div id="privateChatAvatar" class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold">C</div>
                 <div>
                   <h4 id="privateChatHeaderName" class="font-bold text-slate-800">Seleccione un contacto</h4>
                   <p class="text-xs text-slate-500">Última conexión: Hoy 10:30 AM</p>
                 </div>
               </div>
               <button class="text-slate-400 hover:text-slate-600"><i data-lucide="more-vertical" class="w-5 h-5"></i></button>
             </div>
             
             <div id="privateChatMessages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50/50">
                <div class="text-center text-slate-400 text-sm mt-10">Seleccione un padre de la lista para iniciar el chat.</div>
             </div>
             
             <div class="p-4 border-t bg-white">
               <div class="flex items-center gap-2">
                 <button class="p-2 text-slate-400 hover:bg-slate-100 rounded-full"><i data-lucide="paperclip" class="w-5 h-5"></i></button>
                 <input id="privateChatInput" type="text" placeholder="Escribe un mensaje..." class="flex-1 bg-slate-100 border-none rounded-full px-4 py-2 text-sm focus:ring-2 focus:ring-karpus-blue">
                 <button id="privateChatSendBtn" class="p-2 bg-karpus-blue text-white rounded-full hover:bg-blue-700 transition-colors"><i data-lucide="send" class="w-5 h-5"></i></button>
               </div>
             </div>
          </div>
        </div>
      </div>

      <!-- TAB: ATTENDANCE -->
      <div id="tab-attendance" class="class-tab-content space-y-4 hidden">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold">Registro de Asistencia</h3>
          <div class="text-sm text-slate-500 today-date-display"></div>
        </div>
        <div class="bg-white rounded-3xl p-6 border text-center">
           <div id="attendanceInterface">
             <!-- Attendance Grid will go here -->
             <p class="text-slate-400">Seleccione fecha para ver o tomar asistencia.</p>
           </div>
        </div>
      </div>

    </section>

    <!-- Calendar Section -->
    <section id="t-calendar" class="section space-y-3 hidden">
      <h2 class="text-xl font-semibold flex items-center gap-2">
        <i data-lucide="calendar" class="w-5 h-5 text-karpus-orange"></i><span>Calendario Escolar</span>
      </h2>
      <div class="bg-white rounded-3xl p-4 border h-96 flex items-center justify-center text-slate-400">
        Vista de Calendario
      </div>
    </section>

    <!-- Profile -->
    <section id="t-profile" class="section space-y-3 hidden">
      <h2 class="text-xl font-semibold flex items-center gap-2">
        <i data-lucide="user-cog" class="w-5 h-5 text-karpus-blue"></i><span>Perfil y Herramientas</span>
      </h2>
      <div class="rounded-3xl bg-white p-4 border mt-2">
        <h3 class="text-sm font-semibold mb-2">Perfil de la Maestra</h3>
        <div class="grid md:grid-cols-2 gap-3">
          <div>
            <label class="block text-xs">Nombre</label>
            <input id="pfName" class="w-full border rounded-xl px-2 py-1 text-sm" />
            <label class="block text-xs mt-2">Email</label>
            <input id="pfEmail" class="w-full border rounded-xl px-2 py-1 text-sm" />
            <label class="block text-xs mt-2">Teléfono</label>
            <input id="pfPhone" class="w-full border rounded-xl px-2 py-1 text-sm" />
          </div>
          <div>
            <label class="block text-xs">Biografía</label>
            <textarea id="pfBio" rows="4" class="w-full border rounded-xl px-2 py-1 text-sm"></textarea>
            <label class="block text-xs mt-2">Avatar</label>
            <input id="pfAvatar" type="file" accept="image/*" class="w-full border rounded-xl px-2 py-1 text-sm" />
          </div>
        </div>
        <div class="flex items-center gap-3 mt-3">
          <button id="saveProfile" class="text-sm px-3 py-2 rounded-xl bg-karpus-green text-white">Guardar</button>
          <button id="openViewParents" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Ver padres</button>
          <button id="openCalendar" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Calendario</button>
          <button id="openMessage" class="text-sm px-3 py-2 rounded-xl bg-karpus-pink text-white">Mensaje</button>
          <button id="openExport" class="text-sm px-3 py-2 rounded-xl bg-karpus-orange text-white">Exportar</button>
      
        </div>
      </div>
      
      <!-- Settings moved to Profile -->
      <div class="rounded-3xl bg-white p-4 border mt-4">
        <h3 class="text-sm font-semibold mb-3 text-slate-700">Configuración de Cuenta</h3>
        <div class="space-y-3">
          <label class="flex items-center gap-2">
            <input type="checkbox" class="rounded text-karpus-blue focus:ring-karpus-blue" checked />
            <span class="text-sm">Notificaciones por correo</span>
          </label>
          <label class="flex items-center gap-2">
            <input type="checkbox" class="rounded text-karpus-blue focus:ring-karpus-blue" />
            <span class="text-sm">Modo oscuro (beta)</span>
          </label>
          <div class="pt-2">
            <button class="text-sm text-blue-600 hover:underline">Cambiar contraseña</button>
          </div>
        </div>
      </div>
    </section>

    </main>
  </div>

  <!-- Modales auxiliares (Tasks) -->
  <div id="modalAddPost" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-96">
      <h3 class="text-sm font-semibold mb-2">Nueva Publicación</h3>
      <input id="postTitle" class="w-full border rounded-xl p-2 text-sm" placeholder="Título" />
      <textarea id="postContent" class="w-full border rounded-xl p-2 text-sm mt-2" rows="3" placeholder="Contenido..."></textarea>
      <label class="block text-xs text-slate-600 mt-2">Adjuntar imagen/video</label>
      <input id="postFile" type="file" accept="image/*,video/*" class="w-full border rounded-xl p-2 text-sm" />
      <div class="flex justify-end gap-2 mt-3">
        <button id="closeAddPost" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cancelar</button>
        <button id="submitPost" class="text-sm px-3 py-2 rounded-xl bg-karpus-orange text-white">Publicar</button>
      </div>
    </div>
  </div>

  <div id="modalHistory" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-96">
      <h3 class="text-sm font-semibold mb-2">Historial de Aula</h3>
      <div id="historyList" class="space-y-2 max-h-64 overflow-auto"></div>
      <div class="flex justify-end mt-3">
        <button id="closeHistory" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button>
      </div>
    </div>
  </div>

  <div id="modalCreateTask" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Nueva Tarea</h3>
      <input id="taskTitle" class="w-full border rounded-xl p-2 text-sm" placeholder="Título" />
      <textarea id="taskDesc" class="w-full border rounded-xl p-2 text-sm mt-2" rows="3" placeholder="Descripción"></textarea>
      <label class="block text-xs text-slate-600 mt-2">Fecha de entrega</label>
      <input id="taskDue" type="date" class="w-full border rounded-xl p-2 text-sm" />
      <div class="flex justify-end gap-2 mt-3">
        <button id="closeCreateTask" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cancelar</button>
        <button id="submitTask" class="text-sm px-3 py-2 rounded-xl bg-karpus-blue text-white">Guardar</button>
      </div>
    </div>
  </div>

  <div id="modalGradeTask" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Calificar Tarea: <span id="gradeTaskTitle" class="font-normal"></span></h3>
      <div id="gradeList" class="space-y-3 max-h-72 overflow-auto">
        <!-- Las entregas de los estudiantes se renderizarán aquí -->
        <p class="text-center text-sm text-slate-500 p-4">No hay entregas para calificar.</p>
      </div>
      <div class="flex justify-end gap-2 mt-3">
        <button id="closeGradeTask" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button>
        <button id="saveGrades" class="text-sm px-3 py-2 rounded-xl bg-karpus-orange text-white">Guardar Calificaciones</button>
      </div>
    </div>
  </div>

  <div id="modalViewSubmissions" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Entregas de estudiantes</h3>
      <div id="submissionsList" class="space-y-2 max-h-64 overflow-auto"></div>
      <div class="flex justify-end mt-3"><button id="closeViewSubmissions" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button></div>
    </div>
  </div>

  <div id="modalSendNotification" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Enviar notificación</h3>
      <textarea id="notifText" class="w-full border rounded-xl p-2 text-sm" rows="3" placeholder="Mensaje"></textarea>
      <div class="flex justify-end gap-2 mt-3">
        <button id="closeSendNotification" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cancelar</button>
        <button id="submitNotification" class="text-sm px-3 py-2 rounded-xl bg-karpus-pink text-white">Enviar</button>
      </div>
    </div>
  </div>

  <div id="modalViewParents" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-96">
      <h3 class="text-sm font-semibold mb-2">Padres</h3>
      <div id="parentsList" class="space-y-2 max-h-64 overflow-auto"></div>
      <div class="flex justify-end mt-3"><button id="closeViewParents" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button></div>
    </div>
  </div>

  <div id="modalCalendar" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Calendario</h3>
      <p class="text-sm text-slate-600">(Placeholder de calendario)</p>
      <div class="flex justify-end mt-3"><button id="closeCalendar" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button></div>
    </div>
  </div>

  <div id="modalMessage" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Mensaje privado</h3>
      <select id="messageTo" class="w-full border rounded-xl p-2 text-sm bg-white"></select>
      <textarea id="messageText" class="w-full border rounded-xl p-2 text-sm mt-2" rows="3" placeholder="Mensaje"></textarea>
      <div class="flex justify-end gap-2 mt-3"><button id="closeMessage" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cancelar</button><button id="sendMessage" class="text-sm px-3 py-2 rounded-xl bg-karpus-pink text-white">Enviar</button></div>
    </div>
  </div>

  <div id="modalExport" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-80">
      <h3 class="text-sm font-semibold mb-2">Exportar</h3>
      <p class="text-sm text-slate-600">Generar reporte de aula (placeholder).</p>
      <div class="flex justify-end gap-2 mt-3"><button id="closeExport" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cerrar</button><button id="doExport" class="text-sm px-3 py-2 rounded-xl bg-karpus-orange text-white">Exportar</button></div>
    </div>
  </div>

  <div id="modalBehaviorReport" class="modal-container">
    <div class="modal-content bg-white rounded-3xl p-4 w-96">
      <h3 class="text-sm font-semibold mb-2 flex items-center gap-2">
        <i data-lucide="alert-circle" class="w-4 h-4 text-karpus-orange"></i>
        Reporte de Comportamiento
      </h3>
      <p class="text-xs text-slate-500 mb-3">Estudiante: <span id="behaviorStudentName" class="font-bold text-slate-700"></span></p>
      
      <label class="block text-xs text-slate-600 mb-1">Tipo de incidente</label>
      <select id="behaviorType" class="w-full border rounded-xl p-2 text-sm bg-white mb-2"><option>Comportamiento disruptivo</option><option>Falta de tarea</option><option>Uso de lenguaje inapropiado</option><option>Otro</option></select>
      
      <label class="block text-xs text-slate-600 mb-1">Descripción / Observación</label>
      <textarea id="behaviorDesc" class="w-full border rounded-xl p-2 text-sm" rows="3" placeholder="Describa lo sucedido..."></textarea>
      
      <div class="flex justify-end gap-2 mt-3"><button id="closeBehaviorReport" class="text-sm px-3 py-2 rounded-xl bg-slate-100">Cancelar</button><button id="sendBehaviorReport" class="text-sm px-3 py-2 rounded-xl bg-karpus-orange text-white">Enviar Reporte</button></div>
    </div>
  </div>

  <div id="sidebarOverlay"></div>

  <script src="js/store.js?v=2" defer></script>
  <script src="js/panel_maestra.js"></script>
  <script src="js/common_ui.js"></script>
</body>
</html>
